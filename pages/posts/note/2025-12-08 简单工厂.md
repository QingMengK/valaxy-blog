---
title:
  - 工厂模式与抽象工厂模式
created: 2025-12-08
updated: 2025-12-08
type: 📘 知识节点
tags:
  - 面向对象
  - 设计模式
  - 创建型模式
---
> 工厂模式是一种将“对象的创建”从“对象的使用”中分离出来的设计思路。它通过引入工厂来负责实例化对象，让调用者无需知道具体类的构造方式，只需向工厂要相应的产品即可。这样不仅能让代码结构更加清晰，也能提升扩展性与维护性。当需要新增产品或调整创建逻辑时，只需改动工厂部分，而不用影响业务代码，从而让系统在不断增长的需求下保持稳定与灵活。
## 一、背景故事（为什么会想到要用工厂？）

你是一名手机商城系统的开发者。  
一天，产品经理找到你，说：

> “我们商城要卖手机，你先支持两种：iPhone 和华为。  
> 用户点击下单时，我们要创建对应的手机对象，然后打印手机型号。”

你想：这很简单啊，不就 new 一个类吗？

于是你迅速写出了打印手机型号的代码。

然而没过几天，产品经理又来找你：

> “手机种类越来越多了，后面还有小米、三星、OPPO、vivo……  
> 而且有些手机需要在创建前做配置检查，有些需要读取序列号，有些需要进行权限校验。  
> 你能不能把创建手机的逻辑统一一下？不要每次都在 main 里加 if-else 了。”

这时你意识到：

- 手机的种类会一直增加
    
- 每种手机的构造过程可能不同
    
- 主程序不能一直改来改去
    
- “如何创建”“怎么使用”必须分离
    

于是你开始学习“工厂模式”。
## 二、如果不使用工厂模式（直接 new 的写法）
```java
public class FactoryPattern {
    public static void main(String[] args) {
        // 假设根据用户选择创建对应手机
        String type = "huawei";  

        Phone phone;

        if (type.equals("iphone")) {
            phone = new iphone();
        } else if (type.equals("huawei")) {
            phone = new HuaWeiPhone();
        } else {
            throw new RuntimeException("不支持的手机类型");
        }

        phone.print();
    }
}

```
### 🔍 看起来不复杂，但问题不断：

### 1. 主程序必须知道所有手机类：

- iphone
    
- HuaWeiPhone
    
- 未来的小米、小米Pro、三星、三星折叠、OPPO、vivo……
    

主程序不断变胖、越来越难维护。

---

### 2. 一旦新增手机，必须修改 main（违反开闭原则）

新增 XiaomiPhone：

```java
else if (type.equals("xiaomi")) {     phone = new XiaomiPhone(); }`
```

新增 10 种品牌，就要写 10 个 if-else。


---
### 3. 手机创建逻辑可能越来越复杂

比如 HuaweiPhone 未来需要：

```java
public HuaWeiPhone() {
     String imei = loadIMEIFromServer();
     checkSecurityConfig();     
     initDriver();
    }
```

构造函数越来越大，main 被迫关心流程细节。

---

### 4. 项目越大，破面越多

你可能不止一个地方 new 手机：

- 下单时创建手机
    
- 评价页面创建手机
    
- 仓库管理系统创建手机
    
- 测试工具创建手机
    

这些地方都需要修改代码，自然容易出 Bug。
## 三、使用工厂模式（让“造手机”和“用手机”分离）

当你引入工厂后：
```java
Factory factory = new HuaWeiFactory();
Phone phone = factory.createPhone();
phone.print();
```
你不再关心：

- 手机构造方式
    
- 手机品牌数量
    
- 构造中是否需要配置校验
    
- 是否需要读取服务器数据
    

你只需要：**我要一台华为手机，就去找华为工厂要就行了。**
### 背后逻辑全部封装在工厂里：
```java
class HuaWeiFactory implements Factory {
    @Override
    public Phone createPhone() {
        // 未来这里可以放 100 行构造逻辑
        return new HuaWeiPhone();
    }
}
```

新增 XiaomiPhone？
只需要：
```java
class XiaomiFactory implements Factory {
    @Override
    public Phone createPhone() {
        return new XiaomiPhone();
    }
}

```