---
title:
  - 原型模式
created: 2025-12-10
updated: 2025-12-10
type: 📘 知识节点
tags:
  - 面向对象
  - 设计模式
---
> 摘要：Prototype（原型模式）用于在无需重新创建对象的情况下，通过克隆现有对象来快速生成新实例。适用于对象创建昂贵、初始化复杂，或需要复制带有既定状态的实例的场景。通过克隆可以减少创建成本，提高性能，并允许灵活调整复制后的对象属性。


**Prototype（原型模式）**是一种创建型设计模式，它通过 **复制已有对象（Clone）** 来创建新对象，而不是通过 `new` 进行创建。

它解决的核心问题是：

> **当一个对象的创建成本很高、初始化步骤复杂、或需要大量配置时，可以通过克隆一个已有对象来创建新的实例。**

# 🔍1. 背景小故事（为什么需要 Prototype？）

想象你在做一个 RPG 游戏的角色系统：

- 每个角色有大量属性：力量、敏捷、智力、技能树、装备栏、基础状态。
    
- 初始化一个角色很麻烦，需要经历：
    
    - 数据库加载
        
    - 初始化技能
        
    - 绑定动画
        
    - 注册到 AI 系统
        
    - 设置碰撞体
        
    - ……
        

如果你要创建多个“基础相同”的角色，比如“普通士兵 100 个”，使用 `new Soldier()` 将重复大量复杂的初始化操作，非常浪费性能。

于是你可以：

- 先创建一个“士兵原型（prototype）”
    
- 需要士兵时 **直接克隆（clone）**
    

👉 初始化只做一次，后面全部通过复制完成。
# 🧩 2. Prototype 不使用时（传统方式）
```java
Soldier s1 = new Soldier();
s1.initFromDB();
s1.loadSkillTree();
s1.bindAnimation();
s1.setDefaults();
...

Soldier s2 = new Soldier();
s2.initFromDB();
s2.loadSkillTree();
...
// 重复很多遍

```
缺点：

- 相同代码重复执行
    
- 大量构造成本
    
- 不便将对象“复制”到一个相似但不相同的状态
# 🌟 3. 使用 Prototype 时（克隆方式）
我们让 Soldier 实现 `Cloneable` 接口：
```java
class Soldier implements Cloneable {
    int hp;
    int attack;
    SkillTree skills;

    public Soldier clone() {
        try {
            return (Soldier) super.clone();
        } catch (Exception e) {
            return null;
        }
    }
}

```
使用方式:
```java
Soldier prototype = new Soldier();
prototype.initFromDB();  // 只做一次
prototype.loadSkillTree();

Soldier soldier1 = prototype.clone();
Soldier soldier2 = prototype.clone();

```

优点非常显著：

- 避免重复昂贵初始化
    
- 灵活定制克隆后的小差异
    
- 简化创建过程

# 🏗️ 4. Prototype 适用场景

你可以在以下场景中使用原型模式：

### ✔ 创建对象成本巨大、初始化繁琐

如：角色、地图块、UI 模块、数据库实体。

### ✔ 创建对象的过程非常复杂

工厂模式也能解决部分问题，但 Prototype 速度更快，因为不走构造流程。

### ✔ 创建对象需要“保持一些已有状态”

例如：复制编辑器中的节点、Unity Prefab 的复制。

### ✔ 需要大量同类对象

如：子弹、敌人、粒子系统等
# 🧠 5. 对比其他创建型模式（帮助你记忆）
|模式|核心思想|适合场景|
|---|---|---|
|**Factory Method**|子类决定创建哪种“产品”|解决产品族、扩展产品类型|
|**Abstract Factory**|创建多个相关产品|解决产品族兼容问题|
|**Builder**|分步骤构建复杂对象|复杂构造顺序固定|
|**Prototype**|通过复制已有对象创建新对象|对象创建成本高或需要复制状态|

Prototype 最大的特点是：  
**绕过构造函数，通过复制已有对象来完成创建。**


```java
interface Prototype{
	Object clone();
}


class Plane implements Prototype{
	private String name;
	private String type;
	
	public Plane(){
		name = "Name:" + Math.random();
		type = "Type:" + Math.random();
	}
	public Plane(Plane plane){
		this.name = plane.name;
		this.tyoe = plane.type;
	}
	
	public String getName(){
		return name;
	}
	
	public String getType(){
		return type;
	}
	
	@Override
	public Object clone(){
		return new Pl
	}
}
```
